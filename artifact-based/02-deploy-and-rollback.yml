#
# The output generated by this tool should be used as a base for further
# modifications. It does not make assumptions as to what things can be made into
# variables, modules, partials or Jinja templates. This is your responsibility as
# the owner of the template.
#
# Some recommendations to massage the initial output:
#
# * Rename the pipeline stage IDs, notification names and trigger names to be
#   more meaningful. Enumerated stage IDs is ultimately a detriment for
#   long-term maintainability.
# * The template is currently ordered, so keys may not necessarily be structured
#   in the most sensible format. You may want to massage the template a little.

INFO[0000] configuration:
  concurrentExecutions:
    limitConcurrent: true
    parallel: false
  expectedArtifacts:
  - defaultArtifact:
      kind: default.bitbucket
      name: deploys/deployment-simple.yml
      reference: https://api.bitbucket.org/1.0/repositories/sher-locked/simple-deploy/raw/master/deploys/deployment-simple.yml
      type: bitbucket/file
    id: 33022621-2435-46d0-baa8-799a76311d7a
    matchArtifact:
      kind: bitbucket
      name: deploys/deployment-simple.yml
      type: bitbucket/file
    useDefaultArtifact: true
    usePriorExecution: false
  - defaultArtifact:
      kind: default.bitbucket
      name: deploys/service-simple.yml
      reference: https://api.bitbucket.org/1.0/repositories/sher-locked/simple-deploy/raw/master/deploys/service-simple.yml
      type: bitbucket/file
    id: 38eefab0-78e4-4c9e-b779-4957de38e47b
    matchArtifact:
      kind: bitbucket
      name: deploys/service-simple.yml
      type: bitbucket/file
    useDefaultArtifact: true
    usePriorExecution: false
  triggers:
  - branch: master
    enabled: false
    name: unnamed0
    project: sher-locked
    slug: simple-deploy
    source: bitbucket
    type: git
id: v2deploy-13DeploywithRollback
metadata:
  description: This template does not have a description
  name: 1.3-Deploy-with-Rollback
  owner: OpsMxUser
  scopes:
  - v2deploy
protect: false
schema: "1"
stages:
- config:
    account: my-k8s-v2-account
    cloudProvider: kubernetes
    manifestArtifactAccount: my-bitbucket-account
    manifestArtifactId: 33022621-2435-46d0-baa8-799a76311d7a
    moniker:
      app: v2deploys
    relationships:
      loadBalancers: []
      securityGroups: []
    requiredArtifactIds: []
    source: artifact
  dependsOn:
  - jenkins22
  id: deployManifest8
  inheritanceControl: {}
  inject: {}
  name: Deploy Simple
  type: deployManifest
- config:
    failPipeline: true
    judgmentInputs:
    - value: Accept
    - value: Rollback
    notifications: []
  dependsOn:
  - deployManifest8
  id: manualJudgment20
  inheritanceControl: {}
  inject: {}
  name: Manual Judgment
  type: manualJudgment
- config:
    continuePipeline: false
    failPipeline: true
    job: bitbucket-restapp
    master: opsmx-jenkins-master
    parameters: {}
    propertyFile: file.txt
  id: jenkins22
  inheritanceControl: {}
  inject: {}
  name: Jenkins
  type: jenkins
- config:
    account: my-k8s-v2-account
    cloudProvider: kubernetes
    kind: deployment
    location: production
    manifestName: deployment simple
    numRevisionsBack: 1
    stageEnabled:
      expression: ${#judgment("Manual Judgment").equals("Rollback")}
      type: expression
  dependsOn:
  - manualJudgment20
  id: undoRolloutManifest24
  inheritanceControl: {}
  inject: {}
  name: Undo Rollout (Manifest)
  type: undoRolloutManifest
