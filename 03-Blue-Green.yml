INFO[0000] # GENERATED BY roer
#
# The output generated by this tool should be used as a base for further
# modifications. It does not make assumptions as to what things can be made into
# variables, modules, partials or Jinja templates. This is your responsibility as
# the owner of the template.
#
# Some recommendations to massage the initial output:
#
# * Rename the pipeline stage IDs, notification names and trigger names to be
#   more meaningful. Enumerated stage IDs is ultimately a detriment for
#   long-term maintainability.
# * The template is currently ordered, so keys may not necessarily be structured
#   in the most sensible format. You may want to massage the template a little.

INFO[0000] configuration:
  concurrentExecutions:
    limitConcurrent: true
    parallel: false
  expectedArtifacts:
  - defaultArtifact:
      kind: default.bitbucket
      name: deploys/deployment-blue.yml
      reference: https://api.bitbucket.org/1.0/repositories/sher-locked/simple-deploy/raw/master/deploys/deployment-blue.yml
      type: bitbucket/file
    id: 33022621-2435-46d0-baa8-799a76311d7a
    matchArtifact:
      kind: bitbucket
      name: deploys/deployment-blue.yml
      type: bitbucket/file
    useDefaultArtifact: true
    usePriorExecution: false
  - defaultArtifact:
      kind: default.bitbucket
      name: deploys/deployment-green.yml
      reference: https://api.bitbucket.org/1.0/repositories/sher-locked/simple-deploy/raw/master/deploys/deployment-green.yml
      type: bitbucket/file
    id: 38eefab0-78e4-4c9e-b779-4957de38e47b
    matchArtifact:
      kind: bitbucket
      name: deploys/deployment-green.yml
      type: bitbucket/file
    useDefaultArtifact: true
    usePriorExecution: false
  - defaultArtifact:
      kind: default.bitbucket
      name: deploys/service-blue.yml
      reference: https://api.bitbucket.org/1.0/repositories/sher-locked/simple-deploy/raw/master/deploys/service-blue.yml
      type: bitbucket/file
    id: 2fa9c846-887d-482b-8050-cc519cdd5bc2
    matchArtifact:
      kind: bitbucket
      name: deploys/service-blue.yml
      type: bitbucket/file
    useDefaultArtifact: true
    usePriorArtifact: false
    usePriorExecution: false
  - defaultArtifact:
      kind: default.bitbucket
      name: deploys/service-green.yml
      reference: https://api.bitbucket.org/1.0/repositories/sher-locked/simple-deploy/raw/master/deploys/service-green.yml
      type: bitbucket/file
    id: 7b3e3c84-954e-418e-bf22-5b6287aafd2e
    matchArtifact:
      kind: bitbucket
      name: deploys/service-green.yml
      type: bitbucket/file
    useDefaultArtifact: true
    usePriorExecution: false
  triggers:
  - branch: master
    enabled: false
    name: unnamed0
    project: sher-locked
    slug: simple-deploy
    source: bitbucket
    type: git
id: v2deploy-22BlueGreenDeploy
metadata:
  description: This template does not have a description
  name: 2.2-Blue-Green-Deploy
  owner: opsmxemp1
  scopes:
  - v2deploy
protect: false
schema: "1"
stages:
- config:
    account: my-k8s-v2-account
    cloudProvider: kubernetes
    manifestArtifactAccount: my-bitbucket-account
    manifestArtifactId: 38eefab0-78e4-4c9e-b779-4957de38e47b
    moniker:
      app: v2deploys
    relationships:
      loadBalancers: []
      securityGroups: []
    requiredArtifactIds: []
    source: artifact
  dependsOn:
  - jenkins20
  id: deployManifest8
  inheritanceControl: {}
  inject: {}
  name: Green Deploy
  type: deployManifest
- config:
    continuePipeline: false
    failPipeline: true
    job: bitbucket-restapp
    master: opsmx-jenkins-master
    parameters: {}
  id: jenkins20
  inheritanceControl: {}
  inject: {}
  name: Jenkins
  type: jenkins
- config:
    account: my-k8s-v2-account
    cloudProvider: kubernetes
    kinds: []
    location: production
    manifestArtifactAccount: my-bitbucket-account
    manifestArtifactId: 7b3e3c84-954e-418e-bf22-5b6287aafd2e
    manifestName: ""
    moniker:
      app: v2deploys
    options:
      cascading: true
    relationships:
      loadBalancers: []
      securityGroups: []
    source: artifact
  dependsOn:
  - deployManifest8
  id: deployManifest21
  inheritanceControl: {}
  inject: {}
  name: Traffic to Green
  type: deployManifest
- config:
    failPipeline: true
    judgmentInputs:
    - value: Accept
    - value: Rollback
    notifications: []
  dependsOn:
  - deployManifest21
  id: manualJudgment22
  inheritanceControl: {}
  inject: {}
  name: Manual Judgment
  type: manualJudgment
- config:
    account: my-k8s-v2-account
    cloudProvider: kubernetes
    manifestArtifactAccount: my-bitbucket-account
    manifestArtifactId: 2fa9c846-887d-482b-8050-cc519cdd5bc2
    moniker:
      app: v2deploys
    relationships:
      loadBalancers: []
      securityGroups: []
    source: artifact
    stageEnabled:
      expression: ${#stage("Manual Judgement").equals("Rollback")}
      type: expression
  dependsOn:
  - manualJudgment22
  id: deployManifest23
  inheritanceControl: {}
  inject: {}
  name: Move back to Blue
  type: deployManifest

